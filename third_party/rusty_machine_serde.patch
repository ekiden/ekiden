From ea33885953ec2b1eedcea96344e54cf78edca7f0 Mon Sep 17 00:00:00 2001
From: Nick Hynes <nhynes@berkeley.edu>
Date: Wed, 17 Jan 2018 15:32:26 -0800
Subject: [PATCH] rusty-machine serde

---
 third_party/rulinalg/Cargo.toml                   | 2 ++
 third_party/rulinalg/src/lib.rs                   | 4 ++++
 third_party/rulinalg/src/matrix/mod.rs            | 2 +-
 third_party/rulinalg/src/vector/mod.rs            | 2 +-
 third_party/rusty-machine/Cargo.toml              | 2 ++
 third_party/rusty-machine/src/learning/lin_reg.rs | 2 +-
 third_party/rusty-machine/src/lib.rs              | 4 ++++
 7 files changed, 15 insertions(+), 3 deletions(-)

diff --git a/third_party/rulinalg/Cargo.toml b/third_party/rulinalg/Cargo.toml
index 35b2f3c..c3114cf 100644
--- a/third_party/rulinalg/Cargo.toml
+++ b/third_party/rulinalg/Cargo.toml
@@ -20,6 +20,8 @@ rustc-serialize = { path = "../rustc-serialize", optional = true }
 csv = { path = "../rust-csv", optional = true}
 matrixmultiply = { path = "../matrixmultiply" }
 sgx_tstd = { path = "../../sgx_tstd" }
+serde = { git = "https://github.com/ekiden/serde.git" }
+serde_derive = "1.0.27"
 
 [dev-dependencies]
 rand = "0.3"
diff --git a/third_party/rulinalg/src/lib.rs b/third_party/rulinalg/src/lib.rs
index f853d98..7a55252 100644
--- a/third_party/rulinalg/src/lib.rs
+++ b/third_party/rulinalg/src/lib.rs
@@ -90,6 +90,10 @@
 #[macro_use]
 extern crate sgx_tstd as std;
 
+#[macro_use]
+extern crate serde_derive;
+extern crate serde;
+
 extern crate num as libnum;
 extern crate matrixmultiply;
 
diff --git a/third_party/rulinalg/src/matrix/mod.rs b/third_party/rulinalg/src/matrix/mod.rs
index 8543a40..1a07647 100644
--- a/third_party/rulinalg/src/matrix/mod.rs
+++ b/third_party/rulinalg/src/matrix/mod.rs
@@ -42,7 +42,7 @@ pub enum Axes {
 /// The `Matrix` struct.
 ///
 /// Can be instantiated with any type.
-#[derive(Debug, Clone, PartialEq, Eq, Hash)]
+#[derive(Debug, Clone, PartialEq, Eq, Hash, Serialize, Deserialize)]
 pub struct Matrix<T> {
     rows: usize,
     cols: usize,
diff --git a/third_party/rulinalg/src/vector/mod.rs b/third_party/rulinalg/src/vector/mod.rs
index 41aeeba..42f3470 100644
--- a/third_party/rulinalg/src/vector/mod.rs
+++ b/third_party/rulinalg/src/vector/mod.rs
@@ -9,7 +9,7 @@ mod impl_vec;
 /// The Vector struct.
 ///
 /// Can be instantiated with any type.
-#[derive(Debug, PartialEq, Eq, Hash)]
+#[derive(Debug, PartialEq, Eq, Hash, Serialize, Deserialize)]
 pub struct Vector<T> {
     size: usize,
     data: Vec<T>,
diff --git a/third_party/rusty-machine/Cargo.toml b/third_party/rusty-machine/Cargo.toml
index 9ff2fcb..e9ebd91 100644
--- a/third_party/rusty-machine/Cargo.toml
+++ b/third_party/rusty-machine/Cargo.toml
@@ -20,3 +20,5 @@ num = { path = "../num" , default-features = false }
 sgx_rand = { path = "../../sgx_rand"}
 sgx_tstd = { path = "../../sgx_tstd"}
 rulinalg = { path = "../rulinalg" }
+serde = { git = "https://github.com/ekiden/serde.git" }
+serde_derive = "1.0.27"
diff --git a/third_party/rusty-machine/src/learning/lin_reg.rs b/third_party/rusty-machine/src/learning/lin_reg.rs
index 46c8531..b1d95f3 100644
--- a/third_party/rusty-machine/src/learning/lin_reg.rs
+++ b/third_party/rusty-machine/src/learning/lin_reg.rs
@@ -42,7 +42,7 @@ use learning::error::Error;
 /// Linear Regression Model.
 ///
 /// Contains option for optimized parameter.
-#[derive(Debug)]
+#[derive(Debug, Serialize, Deserialize)]
 pub struct LinRegressor {
     /// The parameters for the regression model.
     parameters: Option<Vector<f64>>,
diff --git a/third_party/rusty-machine/src/lib.rs b/third_party/rusty-machine/src/lib.rs
index e08b3cd..03b2c6d 100644
--- a/third_party/rusty-machine/src/lib.rs
+++ b/third_party/rusty-machine/src/lib.rs
@@ -110,6 +110,10 @@
 #[macro_use]
 extern crate sgx_tstd as std;
 
+#[macro_use]
+extern crate serde_derive;
+extern crate serde;
+
 extern crate rulinalg;
 extern crate num as libnum;
 
-- 
2.15.1

